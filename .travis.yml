language: minimal
sudo: required

services:
  - docker

env:
  - GH_USER=mtneug GH_REPO=freetz FREETZ_TEST_CONFIG=type-7490

addons:
    packages:
      - shellcheck

before_install:
  - docker info
  - shellcheck --version

install: true

script:
  - docker build -t $GH_USER/$GH_REPO .
  - shellcheck *.sh
  - docker run --rm -it -v $PWD/testdata/$FREETZ_TEST_CONFIG:/.config $GH_USER/$GH_REPO build trunk --no-menuconfig
  - test `ls images/*.image -l | wc -l` -eq 1

